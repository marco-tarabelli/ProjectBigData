

---

# Data Simulator

## Overview

The **Data Simulator** project aims to simulate realistic IoT data, capturing patterns that reflect actual phenomena. For example, when simulating an IoT temperature sensor, the data should show values that follow regular temperature fluctuations over time. The simulator generates these data streams and sends them to an IoT broker, such as MQTT, for further processing.

## Project Objective

The primary goal is to develop a **data-simulation engine** that reads from an **input configuration** file and generates data messages. These messages can then be sent to a broker like MQTT or consumed by a system that manages IoT sensors or devices.

## Features

- **Configurable Input**: The engine reads sensor data configuration from a YAML file, allowing flexible and customizable simulation of various sensors.
- **Docker Integration**: Docker containers are used to simulate the sensors, facilitating scalable deployment.
- **MQTT Broker Communication**: Simulated sensor data is sent via MQTT, a popular messaging protocol for IoT.
- **Kafka Integration**: The system also supports Kafka for message brokering and ensures scalable data ingestion and processing.
- **Realistic Sensor Behavior**: The simulator reproduces realistic data behavior, such as fluctuating temperature readings from IoT sensors.

## Components

### Input Configuration
- The configuration is written in **YAML** format.
- Defines the behavior and characteristics of the sensors, such as sensor type, firmware version, data generation ranges, and more.

### Engine
The core part of the simulator, responsible for:
- Reading the configuration file.
- Instantiating Docker images (fetched from Docker Hub) for simulating sensors.
- Coordinating the containers.
- Passing input to the containers via Kafka and receiving output.
- Collecting outputs to create the final simulated message (as JSON).
- Publishing the simulated message to an external broker (e.g., MQTT).

### Docker Images
- Created by third parties (e.g., researchers at Unicam).
- Encapsulate the behavior necessary to generate sensor outputs.
- Interact with the engine to receive inputs (via Kafka) and send output back (via Kafka).
- Handle all background mechanisms for interacting with the engine.

## Architecture

The architecture is divided into several key components:

1. **Engine**: The core simulation engine that reads input configurations and manages data production.
2. **Input Configuration**: YAML-based configuration file that defines the behavior and characteristics of each simulated sensor (e.g., temperature range, frequency of data production).
3. **Docker Hub**: Docker images for the sensors are fetched from a public repository and instantiated as required.
4. **Kafka**: The engine interfaces with Kafka for publishing and subscribing to sensor data messages.
5. **MQTT Broker**: Data generated by the sensors is sent to an MQTT broker for further processing or real-time monitoring.

### Diagram

The following diagram illustrates the system's architecture:

![Screenshot (657)](https://github.com/user-attachments/assets/a794c315-f46c-4cda-866a-af9a9a31d18a)


## Input Configuration

The configuration file defines how the sensors behave and how the data is generated. A sample configuration may look like this:

```yaml
producers:
  - id: sens_temp_1
    data:
      name: TM-873
      type: temperature sensor
      fw_version: 1.0.0v1
      temperature:
        type: "@docker"
        image: iofog/temperature-sensor-simulator
        input:
          min-temp: 10.1
          max-temp: 25.5
        retain-value: true
```

This configuration defines two temperature sensors, specifying their data ranges, Docker images to simulate their behavior, and additional parameters.

## Installation

### Prerequisites

To run the **Data Simulator**, you will need the following:

- Docker
- Docker Compose
- Kafka (inside Docker)
- Python 3.x
- MQTT Broker (e.g., Mosquitto)

### Steps

1. **Clone the Repository**

   ```bash
   git clone https://github.com/your-repo/data-simulator.git
   cd data-simulator
   ```

2. **Build the Docker Image**

   Build the Docker image required for the sensor simulation:

   ```bash
   docker build -t sensor-simulator .
   ```

3. **Build and Start Docker Compose**

   Build and start all required services (Kafka, MQTT, etc.) using Docker Compose:

   ```bash
   docker-compose up --build
   ```

4. **Create Kafka Topics**

   Inside the Kafka container, create the necessary Kafka topics for your sensors:

   ```bash
   docker exec -it kafka-container bash
   kafka-topics --create --topic sensor-data --bootstrap-server localhost:9092 --partitions 1 --replication-factor 1
   ```

5. **Start the MQTT Broker**

   Ensure the MQTT broker (e.g., Mosquitto) is running and listening on the appropriate port (default: 1883).

6. **Subscribe to the MQTT Topics**

   Subscribe to the MQTT topics where the simulated data will be published:

   ```bash
   mosquitto_sub -h localhost -t "sensor/temp" -v
   ```

7. **Run the Simulation Engine**

   Finally, start the simulation engine by providing the input configuration file:

   ```bash
   python simulator.py --config input_config.yaml
   ```

## Usage

Once installed, you can:

- Simulate various types of IoT sensors using predefined YAML configurations.
- Modify the configuration files to simulate different types of sensor data (e.g., temperature, humidity).
- Send data to MQTT brokers and view real-time sensor data.

## Example

Hereâ€™s an example of running the simulator for a temperature sensor:

```bash
python simulator.py --config input_config.yaml
```

This will start the simulation based on the input configuration provided, generating temperature data and publishing it to the MQTT broker.

## Contributing

We welcome contributions! To contribute:

1. Fork the repository
2. Create a new branch (`git checkout -b feature-branch`)
3. Commit your changes (`git commit -m 'Add a new feature'`)
4. Push to the branch (`git push origin feature-branch`)
5. Open a pull request

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---



